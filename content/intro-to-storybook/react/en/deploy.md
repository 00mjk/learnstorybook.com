---
title: 'Deploy Storybook'
tocTitle: 'Deploy'
description: 'Learn how to deploy our Storybook online'
---

No Storybook tutorial would be complete without testing. Testing is essential to creating high quality UIs. In modular systems, miniscule tweaks can result in major regressions. So far we encountered three types of tests:

- **Visual tests** rely on developers to manually look at a component to verify it for correctness. They help us sanity check a component‚Äôs appearance as we build.
- **Snapshot tests** with Storyshots capture a component‚Äôs rendered markup. They help us stay abreast of markup changes that cause rendering errors and warnings.
- **Unit tests** with Jest verify that the output of a component remains the same given an fixed input. They‚Äôre great for testing the functional qualities of a component.

## ‚ÄúBut does it look right?‚Äù

Unfortunately, the aforementioned testing methods alone aren‚Äôt enough to prevent UI bugs. UIs are tricky to test because design is subjective and nuanced. Visual tests are too manual, snapshot tests trigger too many false positives when used for UI, and pixel-level unit tests are poor value. A complete Storybook testing strategy also includes visual regression tests.

## Visual regression testing for Storybook

Visual regression tests are designed to catch changes in appearance. They work by capturing screenshots of every story and comparing them commit-to-commit to surface changes. This is perfect for verifying graphical elements like layout, color, size, and contrast.

<video autoPlay muted playsInline loop style="width:480px; margin: 0 auto;">
  <source
    src="/intro-to-storybook/visual-regression-testing.mp4"
    type="video/mp4"
  />
</video>

Storybook is a fantastic tool for visual regression testing because every story is essentially a test specification. Each time we write or update a story we get a spec for free!

There are a number of tools for visual regression testing. For professional teams we recommend [**Chromatic**](https://www.chromaticqa.com/), an addon made by Storybook maintainers that runs tests in the cloud.

## Setup visual regression testing

Chromatic is a hassle-free Storybook addon for visual regression testing and review in the cloud. Since it‚Äôs a paid service (with a free trial), it may not be for everyone. However, Chromatic is an instructive example of a production visual testing workflow that we'll try out for free. Let‚Äôs have a look.

### Get Chromatic

Add the package as a dependency.

```bash
yarn add -D chromatic
```

Once the package is installed, we'll need to [login to Chromatic](https://www.chromaticqa.com/start) with our GitHub account (Chromatic will only ask for lightweight permissions). Then we'll create a new project called name "taskbox" and copy the unique `project-token` generated for us.

<video autoPlay muted playsInline loop style="width:520px; margin: 0 auto;">
  <source
    src="/intro-to-storybook/chromatic-setup-learnstorybook.mp4"
    type="video/mp4"
  />
</video>

Now we can run the test command by issuing the following in the command line to setup the visual regression tests for our Storybook. Don't forget to replace the unique project token generated by Chromatic in place of `<project-token>`.

```bash
npx chromatic --project-token=<project-token>
```

<div class="aside"><h4>probably use a diferent gif as this is showing a fourth build, not a first. (ask if we can get this)</h4></div>

![Chromatic running](/chromatic/chromatic-cli-run.gif)

<div class="aside">
If your Storybook has a custom build script you may have to <a href="https://www.chromatic.com/docs/setup#command-options">add options</a> to this command.
</div>

Once the first test is complete, we have our test baselines for each story. In other words, we'll have screenshots of the stories we've created so far, these known to be ‚Äúgood‚Äù. Any future changes made to our stories we'll be compared to the baselines.

Aside from this, we'll also get our Storybook deployed online without the need of any additional setup. A link like `https://random-uuid.chromatic.com` will be provided for us. Once we open the link in a browser window we'll see a exact copy of our local Storybook that we've been working on.

![Storybook deployed with chromatic package](/chromatic/chromatic-manual-storybook-deploy.png)

At this point we were able to create a application, implement various types of tests and successfully setup and manually deploy our Storybook with some addons.

But couldn't we do better? Couldn't we automate this process?

The short answer is yes. We can automate this process with relative ease and that's what we'll do next.

### Setup a repository in GitHub

When our project was initialized in the [Get started chapter](/react/en/get-started/), Create React App (CRA) already created a local repository for us. At this stage it's safe to add our files to the first commit.

Issue the following commands to add and commit the changes we've done so far.

```bash
$ git add .
```

Followed by:

```bash
$ git commit -m "taskbox UI"
```

Once that's done, we can go to GitHub and create a new repository for our project [here](https://github.com/new). We'll name it ‚Äútaskbox‚Äù, same as our local project.

![GitHub setup](/intro-to-storybook/github-create-taskbox.png)

In the new repo we'll grab the origin URL of the repo and add it to ours with the following command:

```bash
$ git remote add origin https://github.com/<your username>/taskbox.git
```

Now we can finally add our files to our repository on GitHub with:

```bash
$ git push -u origin master
```

### Setup GitHub actions with Chromatic

So far we've seen how we could deploy our Storybook manually, but now that our project is hosted in a GitHub repository, how can we continue to deploy our Storybook and share it with our team?

GitHub has a solution for this, through a fantastic feature called [actions](https://github.com/features/actions).

But before we implement our action, we'll need to take care of some additional configurations.

More specifically we'll need to setup a way for our action to consume the `project-token` generated by Chromatic.

How can we achieve this?

### Setup our project token using a secret (better wording)

GitHub has a feature that will help us. They're called [secrets](https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets). These allow us to store not only our `project-token`, but also other types of tokens and information.

To add a secret to our project we'll start by opening a browser window to the repo that was setup earlier. Once there, click the `Settings` tab, followed by the item called `Secrets`.

![secrets page](/github/gh-secrets-screen.png)

Then, click the button `New secret`, for name we'll call it `CHROMATIC_PROJECT_TOKEN` and the value will be the `project-token` that Chromatic created for us.

![adding a new secret](/github/gh-create-secret.png)

Add the secret, by clicking the `Add Secret` button.

And that's it. We know have a way to use our project token safely.

### Implementation of the GitHub action

Now that we've taken care of the required configuration, time to implement our own action.

In the root folder of our project, we'll need to create a new one called `.github` and inside it, create another one called `workflows`.

Once that's done we'll need to create a new file called `chromatic.yml` with the following content:

```yaml
# .github/workflows/chromatic.yml
# name of our action
name: 'Chromatic Testing'
# the event that will trigger the action
on: push

# what the action will do
jobs:
  test:
    # the operating system it will run on
    runs-on: ubuntu-latest
    # the list of steps that the action will go through
    steps:
      - uses: actions/checkout@v1
      - run: yarn
      - run: yarn build-storybook
      - uses: chromaui/action@v1
        # options required to the GitHub chromatic action
        with:
          # our project token, to see how to obtain it
          # refer to https://www.learnstorybook.com/intro-to-storybook/react/en/deploy/
          projectToken: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
          token: ${{ secrets.GITHUB_TOKEN }}
          # the name of the folder where Storybook will be exported into.
          storybookBuildDir: storybook-static
```

And that's it, all is required is to commit and push the changes to our repository and we've successfully automated not only our Storybook deployment but also we've setup a visual testing workflow, that can also be used by our team members.

This is helpful for visual review as part of the standard app development process or simply to show off work üíÖ.
